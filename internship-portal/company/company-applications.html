<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Applications - Sabancı University Internship Portal</title>

	<!-- Global stylesheets -->
	<link href="/bs5/template/assets/fonts/inter/inter.css" rel="stylesheet" type="text/css">
	<link href="/bs5/template/assets/icons/phosphor/styles.min.css" rel="stylesheet" type="text/css">
	<link href="/bs5/template/html/layout_1/full/assets/css/ltr/all.min.css" id="stylesheet" rel="stylesheet" type="text/css">
	<link href="/internship-portal/assets/css/sabanci-theme.css" rel="stylesheet" type="text/css">
	<!-- /global stylesheets -->

	<!-- Core JS files -->
	<script src="../../bs5/template/assets/js/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="../../bs5/template/assets/js/jquery/jquery.min.js"></script>
	<!-- /core JS files -->

	<!-- Theme JS files -->
	<script src="../../bs5/template/assets/js/vendor/tables/datatables/datatables.min.js"></script>
	<script src="../../bs5/template/html/layout_1/full/assets/js/app.js"></script>
	<!-- /theme JS files -->
	
	<!-- Custom style for proper scrolling -->
	<style>
		.content-wrapper {
			display: flex;
			flex-direction: column;
			height: 100%;
		}
		.content {
			flex: 1;
			overflow-y: auto;
			padding-bottom: 1rem;
		}
		.page-content {
			height: 100vh;
			display: flex;
			overflow: hidden;
		}
	</style>
</head>

<body>

	<!-- Main navbar -->
	<div class="navbar navbar-dark navbar-expand-lg navbar-static border-bottom border-bottom-white border-opacity-10">
		<div class="container-fluid">
			<div class="d-flex d-lg-none me-2">
				<button type="button" class="navbar-toggler sidebar-mobile-main-toggle rounded-pill">
					<i class="ph-list"></i>
				</button>
			</div>

			<div class="navbar-brand flex-1 flex-lg-0">
				<a href="company-dashboard.html" class="d-inline-flex align-items-center">
					<img src="/internship-portal/assets/images/logo.svg" alt="Sabancı University Logo" class="h-48px me-2">
					<span class="d-none d-sm-inline-block h6 mb-0 ms-2">Sabancı University Internship Portal</span>
				</a>
			</div>

			<ul class="nav flex-row justify-content-end order-1 order-lg-2">
				<li class="nav-item nav-item-dropdown-lg dropdown">
					<a href="#" class="navbar-nav-link navbar-nav-link-icon rounded-pill" data-bs-toggle="dropdown">
						<i class="ph-bell"></i>
						<span class="badge bg-yellow text-black position-absolute top-0 end-0 translate-middle-top zindex-1 rounded-pill mt-1 me-1">5</span>
					</a>
					
					<div class="dropdown-menu dropdown-menu-end dropdown-menu-scrollable-sm wmin-lg-350">
						<div class="d-flex align-items-center border-bottom py-2 px-3">
							<h6 class="mb-0">Notifications</h6>
							<a href="#" class="ms-auto text-body">
								<i class="ph-check-square me-1"></i>
								Mark all as read
							</a>
						</div>

						<div class="dropdown-item d-flex py-2">
							<div class="flex-shrink-0 me-3">
								<div class="bg-success bg-opacity-10 text-success rounded-pill p-2">
									<i class="ph-user-plus"></i>
								</div>
							</div>

							<div class="flex-grow-1">
								<a href="#" class="d-block fw-semibold">New application received</a>
								<span class="text-muted">Marketing Intern position</span>
							</div>
							<div class="flex-shrink-0 align-self-center">
								<span class="text-muted fs-sm">2 hours ago</span>
							</div>
						</div>

						<div class="dropdown-item d-flex py-2">
							<div class="flex-shrink-0 me-3">
								<div class="bg-primary bg-opacity-10 text-primary rounded-pill p-2">
									<i class="ph-check-circle"></i>
								</div>
							</div>

							<div class="flex-grow-1">
								<a href="#" class="d-block fw-semibold">Internship confirmed</a>
								<span class="text-muted">John Doe confirmed Software Developer position</span>
							</div>
							<div class="flex-shrink-0 align-self-center">
								<span class="text-muted fs-sm">1 day ago</span>
							</div>
						</div>

						<div class="text-center border-top p-2">
							<a href="#" class="text-body">View all</a>
						</div>
					</div>
				</li>

				<li class="nav-item nav-item-dropdown-lg dropdown ms-lg-2">
					<a href="#" class="navbar-nav-link align-items-center rounded-pill p-1" data-bs-toggle="dropdown">
						<div class="status-indicator-container">
							<img src="/bs5/template/assets/images/demo/logos/2.svg" class="w-32px h-32px rounded-pill" alt="">
							<span class="status-indicator bg-success"></span>
						</div>
						<span class="d-none d-lg-inline-block mx-lg-2" id="user-display-name">XYZ Corporation</span>
					</a>

					<div class="dropdown-menu dropdown-menu-end">
						<a href="company-profile.html" class="dropdown-item">
							<i class="ph-building me-2"></i>
							Company profile
						</a>
						<a href="company-internships.html" class="dropdown-item">
							<i class="ph-briefcase me-2"></i>
							Posted internships
						</a>
						<a href="company-applications.html" class="dropdown-item">
							<i class="ph-users me-2"></i>
							Applications
						</a>
						<a href="company-settings.html" class="dropdown-item">
							<i class="ph-gear me-2"></i>
							Account settings
						</a>
						<div class="dropdown-divider"></div>
						<a href="#" id="end-impersonation" class="dropdown-item d-none text-warning">
							<i class="ph-user-switch me-2"></i>
							End Impersonation
						</a>
						<a href="../index.html" class="dropdown-item logout-link">
							<i class="ph-sign-out me-2"></i>
							Logout
						</a>
					</div>
				</li>
			</ul>
		</div>
	</div>
	<!-- /main navbar -->

	<!-- Page content -->
	<div class="page-content">

		<!-- Main sidebar -->
		<div class="sidebar sidebar-dark sidebar-main sidebar-expand-lg">

			<!-- Sidebar content -->
			<div class="sidebar-content">

				<!-- Sidebar header -->
				<div class="sidebar-section">
					<div class="sidebar-section-body d-flex justify-content-center">
						<h5 class="sidebar-resize-hide flex-grow-1 my-auto">Navigation</h5>

						<div>
							<button type="button" class="btn btn-flat-white btn-icon btn-sm rounded-pill border-transparent sidebar-control sidebar-main-resize d-none d-lg-inline-flex">
								<i class="ph-arrows-left-right"></i>
							</button>

							<button type="button" class="btn btn-flat-white btn-icon btn-sm rounded-pill border-transparent sidebar-mobile-main-toggle d-lg-none">
								<i class="ph-x"></i>
							</button>
						</div>
					</div>
				</div>
				<!-- /sidebar header -->


				<!-- Main navigation -->
				<div class="sidebar-section">
					<ul class="nav nav-sidebar" data-nav-type="accordion">

						<!-- Main -->
						<li class="nav-item-header">
							<div class="text-uppercase fs-sm lh-sm opacity-50 sidebar-resize-hide">Main</div>
							<i class="ph-dots-three sidebar-resize-show"></i>
						</li>
						<li class="nav-item">
							<a href="company-dashboard.html" class="nav-link">
								<i class="ph-house"></i>
								<span>Dashboard</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="company-internships.html" class="nav-link">
								<i class="ph-briefcase"></i>
								<span>My Internships</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="company-applications.html" class="nav-link active">
								<i class="ph-users"></i>
								<span>Applications</span>
								<span class="badge bg-primary rounded-pill ms-auto">8</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="company-finalized.html" class="nav-link">
								<i class="ph-check-circle"></i>
								<span>Finalized Internships</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="company-evaluations.html" class="nav-link">
								<i class="ph-star"></i>
								<span>Evaluations</span>
							</a>
						</li>

						<!-- Profile -->
						<li class="nav-item-header">
							<div class="text-uppercase fs-sm lh-sm opacity-50 sidebar-resize-hide">Profile</div>
							<i class="ph-dots-three sidebar-resize-show"></i>
						</li>
						<li class="nav-item">
							<a href="company-profile.html" class="nav-link">
								<i class="ph-building"></i>
								<span>Company Profile</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="company-settings.html" class="nav-link">
								<i class="ph-gear"></i>
								<span>Account Settings</span>
							</a>
						</li>
						<li class="nav-item">
							<a href="../index.html" class="nav-link">
								<i class="ph-sign-out"></i>
								<span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
				<!-- /main navigation -->

			</div>
			<!-- /sidebar content -->
			
		</div>
		<!-- /main sidebar -->


		<!-- Main content -->
		<div class="content-wrapper" style="overflow-y: auto;">

			<!-- Content area -->
			<div class="content">

                <!-- Page header -->
                <div class="page-header">
                    <div class="page-header-content d-lg-flex">
                        <div class="d-flex">
                            <h4 class="page-title mb-0">
                                Applications <span class="fw-normal">Review student applications</span>
                            </h4>
                        </div>
                    </div>
                </div>
                <!-- /page header -->

                <!-- Applications table -->
				<div class="card">
					<div class="card-header">
						<h5 class="mb-0">All Applications</h5>
					</div>

					<!-- Filter row -->
					<div class="card-body border-bottom">
						<div class="row align-items-center mb-3">
							<div class="col-lg-12">
								<input type="text" class="form-control" id="studentNameSearch" placeholder="Search by student name...">
							</div>
						</div>
						<div class="row align-items-center">
							<div class="col-lg-3 mb-2 mb-lg-0">
								<select class="form-select" id="filterPosition">
									<option value="">All Internship Positions</option>
									<option value="Software Developer Intern">Software Developer Intern</option>
									<option value="Marketing Intern">Marketing Intern</option>
									<option value="Data Analyst Intern">Data Analyst Intern</option>
								</select>
							</div>
							<div class="col-lg-3 mb-2 mb-lg-0">
								<select class="form-select" id="filterFaculty">
									<option value="">All Faculties</option>
									<option value="FENS">FENS</option>
									<option value="FASS">FASS</option>
									<option value="SBS">SBS</option>
								</select>
							</div>
							<div class="col-lg-3 mb-2 mb-lg-0">
								<select class="form-select" id="filterStatus">
									<option value="">All Statuses</option>
									<option value="Pending Review">Pending Review</option>
									<option value="Accepted">Accepted</option>
									<option value="Rejected">Rejected</option>
								</select>
							</div>
							<div class="col-lg-3 d-flex justify-content-end mb-2 mb-lg-0">
								<button type="button" class="btn btn-primary" id="applyFilter">Apply Filter</button>
							</div>
						</div>
						<div class="row align-items-center mt-3">
							<div class="col-lg-6">
								<label class="form-label">Application Date Range:</label>
								<div class="input-group">
									<span class="input-group-text">From</span>
									<input type="date" class="form-control" id="dateFrom">
									<span class="input-group-text">To</span>
									<input type="date" class="form-control" id="dateTo">
								</div>
							</div>
						</div>
					</div>
					<!-- /filter row -->

					<div class="table-responsive">
						<table class="table table-striped table-hover" id="applicationsTable">
							<thead>
								<tr>
									<th>#</th>
									<th>Student Name</th>
									<th>Faculty</th>
									<th>Internship Position</th>
									<th class="applied-date-column">Applied Date <i class="ph-sort"></i></th>
									<th>Status</th>
									<th class="text-center">Actions</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>1</td>
									<td>
										<div class="d-flex align-items-center">
											<div class="me-3">
												<img src="../../bs5/template/assets/images/demo/users/face11.jpg" class="rounded-circle" width="36" height="36" alt="">
											</div>
											<div>
												<a href="#" class="text-body fw-semibold" data-bs-toggle="modal" data-bs-target="#view_student_profile_modal">John Doe</a>
												<div class="text-muted fs-sm">Computer Science</div>
											</div>
										</div>
									</td>
									<td>FENS</td>
									<td>Software Developer Intern</td>
									<td>2025/04/06</td>
									<td><span class="badge bg-warning bg-opacity-20 text-warning">Pending Review</span></td>
									<td class="text-center">
										<div class="dropdown">
											<button type="button" class="btn btn-outline-light btn-icon btn-sm text-body border-transparent rounded-pill" data-bs-toggle="dropdown">
												<i class="ph-dots-three-vertical"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-end">
												<a href="#" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#view_application_modal"><i class="ph-eye me-2"></i>View Application</a>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-check-circle me-2"></i>Accept</a>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-x-circle me-2"></i>Reject</a>
												<div class="dropdown-divider"></div>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-download-simple me-2"></i>Download Resume</a>
											</div>
										</div>
									</td>
								</tr>
                                <tr>
									<td>2</td>
									<td>
										<div class="d-flex align-items-center">
											<div class="me-3">
												<img src="../../bs5/template/assets/images/demo/users/face1.jpg" class="rounded-circle" width="36" height="36" alt="">
											</div>
											<div>
												<a href="#" class="text-body fw-semibold" data-bs-toggle="modal" data-bs-target="#view_student_profile_modal">Jane Smith</a>
												<div class="text-muted fs-sm">Marketing</div>
											</div>
										</div>
									</td>
									<td>FASS</td>
									<td>Marketing Intern</td>
									<td>2025/04/05</td>
									<td><span class="badge bg-success bg-opacity-20 text-success">Accepted</span></td>
									<td class="text-center">
										<div class="dropdown">
											<button type="button" class="btn btn-outline-light btn-icon btn-sm text-body border-transparent rounded-pill" data-bs-toggle="dropdown">
												<i class="ph-dots-three-vertical"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-end">
												<a href="#" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#view_application_modal"><i class="ph-eye me-2"></i>View Application</a>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-x-circle me-2"></i>Withdraw Offer</a>
												<div class="dropdown-divider"></div>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-download-simple me-2"></i>Download Resume</a>
											</div>
										</div>
									</td>
								</tr>
                                <tr>
									<td>3</td>
									<td>
										<div class="d-flex align-items-center">
											<div class="me-3">
												<img src="../../bs5/template/assets/images/demo/users/face3.jpg" class="rounded-circle" width="36" height="36" alt="">
											</div>
											<div>
												<a href="#" class="text-body fw-semibold" data-bs-toggle="modal" data-bs-target="#view_student_profile_modal">Michael Brown</a>
												<div class="text-muted fs-sm">Software Engineering</div>
											</div>
										</div>
									</td>
									<td>FENS</td>
									<td>Software Developer Intern</td>
									<td>2025/04/04</td>
									<td><span class="badge bg-danger bg-opacity-20 text-danger">Rejected</span></td>
									<td class="text-center">
										<div class="dropdown">
											<button type="button" class="btn btn-outline-light btn-icon btn-sm text-body border-transparent rounded-pill" data-bs-toggle="dropdown">
												<i class="ph-dots-three-vertical"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-end">
												<a href="#" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#view_application_modal"><i class="ph-eye me-2"></i>View Application</a>
												<div class="dropdown-divider"></div>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-download-simple me-2"></i>Download Resume</a>
											</div>
										</div>
									</td>
								</tr>
								<tr>
									<td>4</td>
									<td>
										<div class="d-flex align-items-center">
											<div class="me-3">
												<img src="../../bs5/template/assets/images/demo/users/face2.jpg" class="rounded-circle" width="36" height="36" alt="">
											</div>
											<div>
												<a href="#" class="text-body fw-semibold" data-bs-toggle="modal" data-bs-target="#view_student_profile_modal">Sarah Johnson</a>
												<div class="text-muted fs-sm">Business Administration</div>
											</div>
										</div>
									</td>
									<td>SBS</td>
									<td>Marketing Intern</td>
									<td>2025/04/03</td>
									<td><span class="badge bg-warning bg-opacity-20 text-warning">Pending Review</span></td>
									<td class="text-center">
										<div class="dropdown">
											<button type="button" class="btn btn-outline-light btn-icon btn-sm text-body border-transparent rounded-pill" data-bs-toggle="dropdown">
												<i class="ph-dots-three-vertical"></i>
											</button>
											<div class="dropdown-menu dropdown-menu-end">
												<a href="#" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#view_application_modal"><i class="ph-eye me-2"></i>View Application</a>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-check-circle me-2"></i>Accept</a>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-x-circle me-2"></i>Reject</a>
												<div class="dropdown-divider"></div>
												<a href="javascript:void(0);" class="dropdown-item"><i class="ph-download-simple me-2"></i>Download Resume</a>
											</div>
										</div>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<!-- /applications table -->

				<!-- View Application Modal -->
				<div id="view_application_modal" class="modal fade" tabindex="-1">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Application Details</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
							</div>
							<div class="modal-body">
								<!-- Placeholder content - Needs JS to populate dynamically -->
								<h6 class="fw-semibold">Student: John Doe (Computer Science)</h6>
								<p><strong>Applied for:</strong> Software Developer Intern</p>
								<p><strong>Applied on:</strong> 2025/04/06</p>
								<p><strong>Status:</strong> Pending Review</p>
								<hr>
								<h6>Resume/CV</h6>
								<p><a href="javascript:void(0);">Download Resume (Placeholder)</a></p> 
								<h6>Cover Letter</h6>
								<p>Placeholder for cover letter content...</p>
								<h6>Additional Documents</h6>
								<p>None provided (Placeholder)</p>
								<!-- Add application questions/answers if applicable -->
							</div>
							<div class="modal-footer justify-content-between">
								<div>
									<button type="button" class="btn btn-outline-success"><i class="ph-check-circle me-2"></i>Accept</button>
									<button type="button" class="btn btn-outline-danger ms-1"><i class="ph-x-circle me-2"></i>Reject</button>
								</div>
								<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
				</div>
				<!-- /view application modal -->

				<!-- View Student Profile Modal -->
				<div id="view_student_profile_modal" class="modal fade" tabindex="-1">
					<div class="modal-dialog modal-lg modal-dialog-scrollable">
						<div class="modal-content">
							<div class="modal-header">
								<h5 class="modal-title">Student Profile Preview</h5>
								<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
							</div>
							<div class="modal-body">
								<!-- Placeholder content - Needs JS to populate dynamically -->
								<div class="card card-body">
									<div class="d-flex align-items-center">
										<div class="me-3">
											<img src="../../bs5/template/assets/images/demo/users/face11.jpg" class="rounded-circle" width="80" height="80" alt="">
										</div>
										<div>
											<h5 class="mb-0">John Doe</h5>
											<p class="mb-0 text-muted">Computer Science, Class of 2026</p>
											<p class="mb-0"><i class="ph-envelope me-1"></i> j**n.d*e@sabanciuniv.edu (Placeholder)</p>
										</div>
									</div>
								</div>

								<div class="card card-body mt-3">
									<h6 class="fw-semibold">Skills</h6>
									<p>Java, Python, C++, SQL, Web Development (HTML, CSS, JavaScript), Teamwork, Problem Solving (Placeholder)</p>
								</div>

								<div class="card card-body mt-3">
									<h6 class="fw-semibold">Experience</h6>
									<ul class="list-unstyled">
										<li><strong>Teaching Assistant</strong> - Sabancı University (Sep 2024 - Present)</li>
										<li><strong>Summer Intern</strong> - Local Tech Company (Jun 2024 - Aug 2024)</li>
										<!-- Placeholder -->
									</ul>
								</div>

								<div class="card card-body mt-3">
									<h6 class="fw-semibold">Education</h6>
									<p><strong>Sabancı University</strong><br>B.Sc. in Computer Science<br>Expected Graduation: 2026<br>GPA: 3.8/4.0 (Placeholder)</p>
								</div>

								<div class="card card-body mt-3 text-center">
									<a href="javascript:void(0);" class="btn btn-outline-primary"><i class="ph-download-simple me-2"></i>Download Resume (Placeholder)</a>
								</div>

							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
							</div>
						</div>
					</div>
				</div>
				<!-- /view student profile modal -->

			</div>
			<!-- /content area -->

			<!-- Footer -->
			<div class="navbar navbar-sm navbar-footer border-top">
				<div class="container-fluid">
					<span>&copy; 2023 <a href="#">Sabancı University Internship Portal</a></span>

					<ul class="nav">
						<li class="nav-item">
							<a href="#" class="navbar-nav-link">Privacy Policy</a>
						</li>
						<li class="nav-item ms-md-1">
							<a href="#" class="navbar-nav-link">Terms of Service</a>
						</li>
					</ul>
				</div>
			</div>

		</div>
		<!-- /main content -->

	</div>
	<!-- /page content -->

<script>
	document.addEventListener('DOMContentLoaded', function() {
		// Initialize DataTable for applications
		var applicationsTable = $('#applicationsTable').DataTable({
			autoWidth: false,
			dom: '<"datatable-header"fl><"datatable-scroll"t><"datatable-footer"ip>',
			language: {
				search: '<span class="me-3">Filter:</span> <div class="form-control-feedback form-control-feedback-end flex-fill">_INPUT_<div class="form-control-feedback-icon"><i class="ph-magnifying-glass opacity-50"></i></div></div>',
				searchPlaceholder: 'Type to filter...',
				lengthMenu: '<span class="me-3">Show:</span> _MENU_',
				paginate: { 'first': 'First', 'last': 'Last', 'next': document.dir == "rtl" ? '&larr;' : '&rarr;', 'previous': document.dir == "rtl" ? '&rarr;' : '&larr;' }
			},
			// Hide the built-in search as we're using our custom filters
			searching: true,
			// Initial order set to first column (index 0) in ascending order
			order: [[0, 'asc']]
		});

		// Counter for date sort clicks
		var dateSortClicks = 0;

		// Date sorting functionality
		document.querySelector('.applied-date-column').addEventListener('click', function() {
			dateSortClicks++;
			
			// Cycle through sorting options
			if (dateSortClicks % 3 === 1) {
				// First click: newest to oldest
				applicationsTable.order([4, 'desc']).draw();
				this.innerHTML = 'Applied Date <i class="ph-sort-descending"></i>';
			} else if (dateSortClicks % 3 === 2) {
				// Second click: oldest to newest
				applicationsTable.order([4, 'asc']).draw();
				this.innerHTML = 'Applied Date <i class="ph-sort-ascending"></i>';
			} else {
				// Third click: back to original order (by ID)
				applicationsTable.order([0, 'asc']).draw();
				this.innerHTML = 'Applied Date <i class="ph-sort"></i>';
			}
		});

		// Custom filtering function
		$.fn.dataTable.ext.search.push(
			function(settings, data, dataIndex) {
				// Get filter values
				var studentName = document.getElementById('studentNameSearch').value.toLowerCase();
				var selectedFaculty = document.getElementById('filterFaculty').value;
				var selectedPosition = document.getElementById('filterPosition').value;
				var selectedStatus = document.getElementById('filterStatus').value;
				var dateFrom = document.getElementById('dateFrom').value;
				var dateTo = document.getElementById('dateTo').value;
				
				// Convert string dates to Date objects for comparison
				var fromDate = dateFrom ? new Date(dateFrom) : null;
				var toDate = dateTo ? new Date(dateTo) : null;
				
				// Extract date from the data
				var appliedDateStr = data[4]; // Applied Date is in column 4
				var parts = appliedDateStr.split('/');
				// Format: yyyy/mm/dd
				var appliedDate = new Date(parts[0], parts[1] - 1, parts[2]);
				
				// Extract student name, faculty, position, and status
				// Extract student name from the data
				var studentNameHtml = data[1]; // Student Name is in column 1
				var tempDiv = document.createElement('div');
				tempDiv.innerHTML = studentNameHtml;
				var nameElement = tempDiv.querySelector('.text-body.fw-semibold');
				var actualStudentName = nameElement ? nameElement.textContent.toLowerCase() : '';
				
				var faculty = data[2]; // Faculty is in column 2
				var position = data[3]; // Position is in column 3
				
				// Extract status from the badge
				var statusHtml = data[5]; // Status is in column 5
				tempDiv.innerHTML = statusHtml;
				var status = tempDiv.textContent.trim();
				
				// Student name search match
				var nameMatch = !studentName || actualStudentName.includes(studentName);
				
				// Faculty match
				var facultyMatch = !selectedFaculty || faculty === selectedFaculty;
				
				// Position match
				var positionMatch = !selectedPosition || position === selectedPosition;
				
				// Status match
				var statusMatch = !selectedStatus || status === selectedStatus;
				
				// Date range match
				var dateMatch = true;
				if (fromDate && toDate) {
					dateMatch = appliedDate >= fromDate && appliedDate <= toDate;
				} else if (fromDate) {
					dateMatch = appliedDate >= fromDate;
				} else if (toDate) {
					dateMatch = appliedDate <= toDate;
				}
				
				// Return true only if all conditions match
				return nameMatch && facultyMatch && positionMatch && statusMatch && dateMatch;
			}
		);

		// Apply filter button click handler
		document.getElementById('applyFilter').addEventListener('click', function() {
			// Redraw the table to apply the filters
			applicationsTable.draw();
		});

		// Add event listeners for real-time filtering as the user types in the name search
		document.getElementById('studentNameSearch').addEventListener('keyup', function() {
			applicationsTable.draw();
		});

		// Add clear filters button
		var filterButton = document.getElementById('applyFilter');
		var clearButton = document.createElement('button');
		clearButton.type = 'button';
		clearButton.className = 'btn btn-light ms-2';
		clearButton.textContent = 'Clear Filters';
		clearButton.id = 'clearFilters';
		filterButton.parentNode.appendChild(clearButton);

		// Clear filters function
		document.getElementById('clearFilters').addEventListener('click', function() {
			// Reset all filter inputs
			document.getElementById('studentNameSearch').value = '';
			document.getElementById('filterFaculty').selectedIndex = 0;
			document.getElementById('filterPosition').selectedIndex = 0;
			document.getElementById('filterStatus').selectedIndex = 0;
			document.getElementById('dateFrom').value = '';
			document.getElementById('dateTo').value = '';
			
			// Reset sorting to default (ID ascending)
			applicationsTable.order([0, 'asc']).draw();
			document.querySelector('.applied-date-column').innerHTML = 'Applied Date <i class="ph-sort"></i>';
			dateSortClicks = 0;
		});
	});
</script>

<!-- Add logout script -->
<script>
	document.addEventListener('DOMContentLoaded', () => {
		console.log('Company applications script loaded.');
		
		// Logout functionality
		const logoutLinks = document.querySelectorAll('.logout-link');
		logoutLinks.forEach(link => {
			link.addEventListener('click', () => {
				localStorage.removeItem('userRole');
			});
		});

		// Auth check
		const userRole = localStorage.getItem('userRole');
		const isBeingImpersonated = sessionStorage.getItem('impersonatedUserType') === 'company';
		
		if (userRole !== 'company' && !isBeingImpersonated) {
			alert('Access denied. Redirecting to login page.');
			window.location.href = '../index.html';
		}
	});
</script>

<!-- Impersonation detection script -->
<script>
	document.addEventListener('DOMContentLoaded', function() {
		// Check if an admin is impersonating this user
		const impersonatedUser = sessionStorage.getItem('impersonatedUser');
		const impersonatedUserEmail = sessionStorage.getItem('impersonatedUserEmail');
		const impersonatedUserType = sessionStorage.getItem('impersonatedUserType');
		const impersonatedUserName = sessionStorage.getItem('impersonatedUserName');
		
		if (impersonatedUser && impersonatedUserEmail && impersonatedUserType === 'company') {
			// Update profile display name to show impersonation status
			const userDisplayName = document.getElementById('user-display-name');
			if (userDisplayName) {
				userDisplayName.textContent = `Impersonating: ${impersonatedUserName || impersonatedUserEmail}`;
				userDisplayName.classList.add('text-warning');
			}
			
			// Show the end impersonation option in dropdown
			const endImpersonationOption = document.getElementById('end-impersonation');
			if (endImpersonationOption) {
				endImpersonationOption.classList.remove('d-none');
				
				// Add event listener to end impersonation option
				endImpersonationOption.addEventListener('click', function(e) {
					e.preventDefault();
					// Clear impersonation data
					sessionStorage.removeItem('impersonatedUser');
					sessionStorage.removeItem('impersonatedUserEmail');
					sessionStorage.removeItem('impersonatedUserType');
					sessionStorage.removeItem('impersonatedUserName');
					
					// Redirect back to admin dashboard
					window.location.href = '../admin/admin-dashboard.html';
				});
			}
		}
	});
</script>
</body>
</html> 